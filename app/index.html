<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>COVID-19 MODEL</title>
  </head>

  <body id="mainPage">
    <div class="headerMenu">
      <div class="headerElement l" style="background-color: #bbb;">
        <span
          style="font-size: 50px; cursor: pointer; color: white;"
          onclick="openNav()"
          >&#9776;
        </span>
      </div>
      <div class="headerElement r" style="background-color: #aaa;">
        <h1>COVID-19 AGENT-BASED SIMULATION MODEL</h1>
      </div>
    </div>

    <div id="myNav" class="sidenav">
      <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"
        >&times;</a
      >
      <div id="sliderDIV">
        <h2>Parameters</h2>

        <button class="accordion">Interaction Parameters</button>
        <div class="panel">
          <div class="col-sm">
            <p>Social Distancing:</p>
            <input
              type="range"
              min="0"
              max="1"
              value="0"
              step="0.05"
              class="slider"
              id="repulsionForce"
            />
            <div class="outputContainer">
              <output id="repulsionForceOut" for="repulsionForce">0</output>
            </div>
            <!-- <input type="number" id="initSusceptibleCount" name="initSusceptibleCount" min="100" max="500" value="100"> -->
          </div>
          <div class="col-sm">
            <p>Attraction:</p>
            <input
              type="range"
              min="0"
              max="1"
              value="0"
              step="0.05"
              class="slider"
              id="attractionForce"
            />
            <div class="outputContainer">
              <output id="attractionForceOut" for="attractionForce">
                0
              </output>
            </div>
          </div>
        </div>

        <button class="accordion">Agent Parameters</button>
        <div class="panel">
          <div class="col-sm">
            <p>
              Probability a collision will result in infection (transmission
              probability)
            </p>
            <input
              type="range"
              min="0.00"
              max="1.00"
              step="0.05"
              value="0.90"
              class="slider"
              id="transmissionProb"
            />
            <div class="outputContainer">
              <output id="transmissionProbOut" for="transmissionProb"
                >90%
              </output>
            </div>
          </div>
          <div class="col-sm">
            <p>
              Probability a non-infectious agent becomes immune
            </p>
            <input
              type="range"
              min="0.00"
              max="1.00"
              step="0.05"
              value="0.1"
              class="slider"
              id="nonInToImmuneProb"
            />
            <div class="outputContainer">
              <output id="nonInToImmuneProbOut" for="nonInToImmuneProb"
                >10%</output
              >
            </div>
          </div>
          <!-- <div class="col-sm">
            <p>Size of agents</p>
            <input
              type="range"
              min="0"
              max="10"
              value="1.5"
              step="0.1"
              class="slider"
              id="agentRadius"
            />
            <div class="outputContainer">
              <output id="agentRadiusOut" for="agentRadius">2</output>
            </div>
          </div> -->
          <div class="col-sm">
            <p>
              Probability a collision will result in infection (transmission
              probability)
            </p>
            <input
              type="range"
              min="0.00"
              max="1.00"
              step="0.05"
              value="0.90"
              class="slider"
              id="transmissionProb"
            />
            <div class="outputContainer">
              <output id="transmissionProbOut" for="transmissionProb"
                >90%
              </output>
            </div>
          </div>
          <div class="col-sm">
            <p>
              Probability a non-infectious agent becomes immune
            </p>
            <input
              type="range"
              min="0.00"
              max="1.00"
              step="0.05"
              value="0.1"
              class="slider"
              id="nonInToImmuneProb"
            />
            <div class="outputContainer">
              <output id="nonInToImmuneProbOut" for="nonInToImmuneProb"
                >10%</output
              >
            </div>
          </div>

          <div class="row">
            <div class="col-sm">
              <p>
                Minimum incubation time
              </p>
              <input
                type="range"
                min="1"
                max="7"
                value="7"
                step="1"
                class="slider"
                id="minIncubationTime"
              />
              <div class="outputContainer">
                <output id="minIncubationTimeOut" for="minIncubationTime"
                  >7 days</output
                >
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm">
              <p>
                Maxmimum incubation time
              </p>
              <input
                type="range"
                min="8"
                max="14"
                value="14"
                step="1"
                class="slider"
                id="maxIncubationTime"
              />
              <div class="outputContainer">
                <output id="maxIncubationTimeOut" for="maxIncubationTime"
                  >14 days</output
                >
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm">
              <p>
                Minimum time a patient is infectious
              </p>
              <input
                type="range"
                min="1"
                max="6"
                value="5"
                step="1"
                class="slider"
                id="minInfectiousTime"
              />
              <div class="outputContainer">
                <output id="minInfectiousTimeOut" for="minInfectiousTime"
                  >5 days</output
                >
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm">
              <p>
                Maximum time a patient is infectious
              </p>
              <input
                type="range"
                min="7"
                max="11"
                value="10"
                step="1"
                class="slider"
                id="maxInfectiousTime"
              />
              <div class="outputContainer">
                <output id="maxInfectiousTimeOut" for="maxInfectiousTime"
                  >10 days</output
                >
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm">
              <p>
                Minimum time from end of incubation to death.
              </p>
              <input
                type="range"
                min="1"
                max="16"
                value="15"
                step="1"
                class="slider"
                id="minTimeUntilDead"
              />
              <div class="outputContainer">
                <output id="minTimeUntilDeadOut" for="minTimeUntilDead"
                  >15 days</output
                >
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm">
              <p>
                Maximum time from end of incubation to death.
              </p>
              <input
                type="range"
                min="17"
                max="35"
                value="30"
                step="1"
                class="slider"
                id="maxTimeUntilDead"
              />
              <div class="outputContainer">
                <output id="maxTimeUntilDeadOut" for="maxTimeUntilDead"
                  >30 days</output
                >
              </div>
            </div>
          </div>

          <div class="col-sm">
            <p>
              Circle of infection (how many people one person can infect at
              once)
            </p>
            <input
              type="range"
              min="1"
              max="20"
              value="2"
              class="slider"
              id="infectionCircleRadius"
            />
            <div class="outputContainer">
              <output id="infectionRadiusOut" for="infectionCircleRadius"
                >5</output
              >
            </div>
          </div>
        </div>

        <button class="accordion">Initial Model Setup</button>
        <div class="panel">
          <div class="col-sm">
            <p>Initial number of susceptibles:</p>
            <input
              type="range"
              min="100"
              max="10000"
              value="100"
              step="20"
              class="slider"
              id="initSusceptible"
            />
            <div class="outputContainer">
              <output id="initSusceptibleCount" for="initSusceptible"
                >50</output
              >
            </div>
            <!-- <input type="number" id="initSusceptibleCount" name="initSusceptibleCount" min="100" max="500" value="100"> -->
          </div>
          <div class="col-sm">
            <p>Initial number of infectious:</p>
            <input
              type="range"
              min="1"
              max="200"
              value="1"
              step="5"
              class="slider"
              id="initInfectious"
            />
            <div class="outputContainer">
              <output id="initInfectiousCount" for="initInfectious">3</output>
            </div>
            <!-- <input type="number" id="initSymptomaticCount" name="initSymptomaticCount" min="1" max="20" value="1"> -->
          </div>
          <div class="col-sm">
            <p>Number of communities:</p>
            <input
              type="range"
              min="1"
              max="12"
              value="4"
              step="1"
              class="slider"
              id="numCommunities"
            />
            <div class="outputContainer">
              <output id="numCommunitiesOut" for="numCommunities">4</output>
            </div>
          </div>
        </div>

        <button class="accordion">Presets</button>
        <div class="panel">
          <div class="preset-panel">
            <div class="custom-select" style="width: 250px;">
              <select>
                <option value="0">Select preset:</option>
                <option value="1">Netherlands RIVM Data</option>
                <option value="2">Empty</option>
                <option value="3">Empty</option>
                <option value="4">Empty</option>
              </select>
            </div>
            <div class="row p-3">
              <button type="button" id="reload" class="btn btn-preset">
                Select
              </button>
            </div>
          </div>
        </div>

        <div class="row p-3">
          <button type="button" id="reload" class="btn btn-secondary">
            Reload
          </button>
        </div>
      </div>
    </div>

    <script>
      function openNav() {
        document.getElementById('myNav').style.width = '45%';
      }

      function closeNav() {
        document.getElementById('myNav').style.width = '0%';
      }
    </script>

    <script>
      var acc = document.getElementsByClassName('accordion');
      var i;

      for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener('click', function () {
          this.classList.toggle('active');
          var panel = this.nextElementSibling;
          if (panel.style.maxHeight) {
            panel.style.maxHeight = null;
          } else {
            panel.style.maxHeight = panel.scrollHeight + 'px';
          }
        });
      }
    </script>

    <script>
      var x, i, j, l, ll, selElmnt, a, b, c;
      /*look for any elements with the class "custom-select":*/
      x = document.getElementsByClassName('custom-select');
      l = x.length;
      for (i = 0; i < l; i++) {
        selElmnt = x[i].getElementsByTagName('select')[0];
        ll = selElmnt.length;
        /*for each element, create a new DIV that will act as the selected item:*/
        a = document.createElement('DIV');
        a.setAttribute('class', 'select-selected');
        a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
        x[i].appendChild(a);
        /*for each element, create a new DIV that will contain the option list:*/
        b = document.createElement('DIV');
        b.setAttribute('class', 'select-items select-hide');
        for (j = 1; j < ll; j++) {
          /*for each option in the original select element,
      create a new DIV that will act as an option item:*/
          c = document.createElement('DIV');
          c.innerHTML = selElmnt.options[j].innerHTML;
          c.addEventListener('click', function (e) {
            /*when an item is clicked, update the original select box,
          and the selected item:*/
            var y, i, k, s, h, sl, yl;
            s = this.parentNode.parentNode.getElementsByTagName('select')[0];
            sl = s.length;
            h = this.parentNode.previousSibling;
            for (i = 0; i < sl; i++) {
              if (s.options[i].innerHTML == this.innerHTML) {
                s.selectedIndex = i;
                h.innerHTML = this.innerHTML;
                y = this.parentNode.getElementsByClassName('same-as-selected');
                yl = y.length;
                for (k = 0; k < yl; k++) {
                  y[k].removeAttribute('class');
                }
                this.setAttribute('class', 'same-as-selected');
                break;
              }
            }
            h.click();
          });
          b.appendChild(c);
        }
        x[i].appendChild(b);
        a.addEventListener('click', function (e) {
          /*when the select box is clicked, close any other select boxes,
        and open/close the current select box:*/
          e.stopPropagation();
          closeAllSelect(this);
          this.nextSibling.classList.toggle('select-hide');
          this.classList.toggle('select-arrow-active');
        });
      }
      function closeAllSelect(elmnt) {
        /*a function that will close all select boxes in the document,
    except the current select box:*/
        var x,
          y,
          i,
          xl,
          yl,
          arrNo = [];
        x = document.getElementsByClassName('select-items');
        y = document.getElementsByClassName('select-selected');
        xl = x.length;
        yl = y.length;
        for (i = 0; i < yl; i++) {
          if (elmnt == y[i]) {
            arrNo.push(i);
          } else {
            y[i].classList.remove('select-arrow-active');
          }
        }
        for (i = 0; i < xl; i++) {
          if (arrNo.indexOf(i)) {
            x[i].classList.add('select-hide');
          }
        }
      }
      /*if the user clicks anywhere outside the select box,
  then close all select boxes:*/
      document.addEventListener('click', closeAllSelect);
    </script>

    <main id="main">
      <div id="left-panel">
        <div id="chart-container">
          <canvas id="chart-canvas" width="600px" height="300px"></canvas>
        </div>
        <div id="demographics-container">
          <canvas id="demographics" width="600px" height="400px"></canvas>
        </div>
      </div>
      <div id="right-side-container">
        <div class="statrow">
          <div class="stat" style="background-color: #05befc;">
            <h3>Susceptible</h3>
            <p id="s1"></p>
          </div>
          <div class="stat" style="background-color: #c9e265;">
            <h3>Non-Infectious</h3>
            <p id="s2"></p>
          </div>
          <div class="stat" style="background-color: #fd7e65;">
            <h3>Infectious</h3>
            <p id="s3"></p>
          </div>
          <div class="stat" style="background-color: #a6a6a6;">
            <h3>Immune</h3>
            <p id="s4"></p>
          </div>
          <div class="stat" style="background-color: #000000ff;">
            <h3>Dead</h3>
            <p id="s5"></p>
          </div>
        </div>
        <div id="model-border-canvases-container">
          <canvas id="glCanvas" width="600px" height="600px"></canvas>
          <!-- This canvas is used for drawing a border around each community so must have same witdth and height.it is overlapped with the main agent canvas-->
          <canvas id="BorderCanvas" width="600px" height="600px"></canvas>
        </div>
      </div>
    </main>
  </body>
</html>
